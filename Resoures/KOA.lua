local a={}a.__index=a;local b=game:GetService("Players")local c=game:GetService("ReplicatedStorage")local d=require(c.Sonar)local e=d("PlayerWrapper")local f=d("GuiUtils")local g=d("WorldspaceGuiUtils")local h=d("Binder")local i=d("Maid")local j=d("CharacterData")local k=d("OverheadHealthbar")local l=d("safeDestroy")local m=d("Constants")local n=game:GetService("ReplicatedStorage")._replicationFolder.KeenObserverOverhead:WaitForChild("OverheadGui")n.MaxDistance=250;local o=b.LocalPlayer;local p=e.GetClient()local q={}local r=false;function a.new(s)local t=a;local u=setmetatable({},t)u.Maid=i.new()if s==o.Character then return u end;u.Model=s;u.Player=b:FindFirstChild(s.Name)u.IsLocalPlayer=u.Player==o;u.CharacterData=j.YieldForCharacterData(u.Model)if not u.CharacterData then return u end;u.Gui=n:Clone()u.Gui.Name=u.Player.Name.."KeenObserverUI"u.Gui.Enabled=true;f.ParentToWorkspaceGui(u.Gui)u.Maid:GiveTask(u.Gui)u.Healthbar=k.new(u.Player,u.Gui.Health)u.Maid:GiveTask(u.Healthbar)g.AddWorldspaceGui(u.Gui)u.Gui.Adornee=s;if not u:_checkVisibility()then return u end;if u.CharacterData and u.CharacterData.AilmentAddedSignal then u.Maid:GiveTask(u.CharacterData.AilmentAddedSignal:Connect(function()u:_checkVisibility()end))end;q[u]=true;return u end;function a._checkVisibility(v)local w=v.Model;if w then w=v.Model:FindFirstChild("Ailments")end;if w then w=w:GetAttribute("HideInfo")end;if not w then return true end;task.defer(v.Destroy,v)return false end;function a.ClearAll(x)for y,x in pairs(q)do y:Destroy()end end;function a.Destroy(z)q[z]=nil;l(z)end;p.CharacterChangedSignal:Connect(function()p.Maid.KeenObserverBinder=nil;local A=p:GetCurrentCharacter()if A then if A:Get("KeenObserver")then local B=h.new(m.CharacterTag,a)B:Init()p.Maid.KeenObserverBinder=B end end end)local function C(D)local E=p:GetCurrentCharacter()if not E then return end;if D==true then if not r then local F=h.new(m.CharacterTag,a)F:Init()p.Maid.KeenObserverBinder=F;r=true end elseif D==false then if r then p.Maid.KeenObserverBinder=nil;a.ClearAll()r=false end else if r then p.Maid.KeenObserverBinder=nil;a.ClearAll()r=false else local F=h.new(m.CharacterTag,a)F:Init()p.Maid.KeenObserverBinder=F;r=true end end end;task.wait(1)local E=p:GetCurrentCharacter()if E then local F=h.new(m.CharacterTag,a)F:Init()p.Maid.KeenObserverBinder=F;r=true end;return C
