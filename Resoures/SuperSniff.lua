local a=game:GetService("CollectionService")local b=game:GetService("ReplicatedStorage")local c=game:GetService("SoundService")local d=require(b._replicationFolder.PlayerWrapper):GetClient()local e=require(b._replicationFolder.Food)local f=require(b._replicationFolder.Marker)local g=require(b._replicationFolder.LightingTracker)local h=require(b._replicationFolder.FoVTracker)local i=require(b._replicationFolder.DisplayUtils)local j=require(b._replicationFolder.SoundPlayer)local k=require(b._replicationFolder.Constants)local l=require(b._replicationFolder.ShoomPile)local m=require(b._replicationFolder.CharacterData)local n=require(b._replicationFolder.CreatureInfoService)local o=3;local p=k.ShoomPileConstants;local q=require(b.Storage.ThreatsData)local r=workspace.Terrain;local s={"Food","DrinkableWater","Character","Mud","Egg","Token","NPC","ShoomPile"}local t={["Mud"]=500,["DrinkableWater"]=600,["Food"]=600,["Egg"]=600,["Character"]=900,["Token"]=2000,["NPC"]=900,["ShoomPile"]=375}for u,v in pairs(t)do t[u]=v*getgenv().SuperSniffDistance end;local w={["Food"]={["Image"]="rbxassetid://13557510566",["Color"]=Color3.fromRGB(255,255,255),["ImageSize"]=UDim2.new(0.6,0,0.6,0),["BeamColor"]=Color3.new(1,0.321569,0.0980392)},["DrinkableWater"]={["Image"]="rbxassetid://13557513995",["Color"]=Color3.fromRGB(255,255,255),["ImageSize"]=UDim2.new(0.7,0,0.7,0),["BeamColor"]=Color3.new(0.0901961,0.831373,1)},["Character"]={["Image"]="rbxassetid://13558868225",["ImageSize"]=UDim2.new(0.65,0,0.65,0),["Color"]=nil},["Mud"]={["Image"]="rbxassetid://13049976128",["ImageSize"]=UDim2.new(0.75,0,0.75,0),["Color"]=nil},["Egg"]={["Image"]="rbxassetid://13084788104",["ImageSize"]=UDim2.new(0.75,0,0.75,0),["Color"]=Color3.new(1,0.776,0.733)},["Token"]={["Image"]="rbxassetid://15351428762",["ImageSize"]=UDim2.new(0.75,0,0.75,0),["Color"]=Color3.fromRGB(255,255,255)},["NPC"]={["GetImage"]=function()local x=d:GetCurrentCharacter()if x and x.CharacterData then local y=x.CharacterData:Get("FoodType")return(y=="Omnivore"or y=="Carnivore")and"rbxassetid://137965189809034"or"rbxassetid://14891435644"end;return"rbxassetid://14891435644"end,["ImageSize"]=UDim2.new(0.6,0,0.6,0),["Color"]=Color3.fromRGB(255,255,255)},["ShoomPile"]={["Image"]="rbxassetid://9009086352",["ImageSize"]=UDim2.new(0.6,0,0.6,0),["GetColor"]=function(z)if z then local A=z:GetAttribute("Rarity")if A and p.ShoomPiles[A]then return p.ShoomPiles[A].SniffColor end end;return Color3.fromRGB(255,255,255)end}}local B={["DrinkableWater"]=function(C,D)C.MaxDistance=t[C.Tag]*D;return C.Distance<C.MaxDistance end,["Mud"]=function(C,D)C.MaxDistance=t[C.Tag]*D;return C.Distance<C.MaxDistance end,["Food"]=function(C,D)local E=e.GetFoodFromModel(C.Root)if E then if C.Root:HasTag("Egg")then return false end;local x=d:GetCurrentCharacter()if x then local F=x.ShouldNotBeSwimming;local G=E.FoodData and E.FoodData.Underwater;if not(F and G)then C.MaxDistance=t[C.Tag]*D;if C.Distance<=C.MaxDistance then return E:CanEat()and E:HasFood()end end end end;return false end,["Egg"]=function(C,D)local x=d:GetCurrentCharacter()local E=e.GetFoodFromModel(C.Root)if E and x then if C.Root:HasTag("Egg")then if x:Get("EggStealer")then C.MaxDistance=t[C.Tag]*D;if C.Distance<=C.MaxDistance then return E:CanEat()and E:HasFood()end end end end;return false end,["Character"]=function(C,D)local x=d:GetCurrentCharacter()if C.Root~=x.Model then local H=C.Root:FindFirstChild("Ailments")if H then if H:GetAttribute("Muddy")or H:GetAttribute("HideScent")then return false end end;C.MaxDistance=t[C.Tag]*D;local I=C.Distance<C.MaxDistance;if I and C.Root.PrimaryPart then local J=C.Root.PrimaryPart.Position;local K=Ray.new(J,x.Root.Position-J)local L=not workspace:FindPartOnRayWithWhitelist(K,{r})if not L then local M=Ray.new(J,workspace.CurrentCamera.CFrame.Position-J)L=not workspace:FindPartOnRayWithWhitelist(M,{r})end;return L end;return I end;return false end,["Token"]=function(C,D)if d:IsBoostActive("TokenSniffingBoost")then C.MaxDistance=t[C.Tag]*D;return C.Distance<=C.MaxDistance end;return false end,["NPC"]=function(C,D)C.MaxDistance=t[C.Tag]*D;return C.Distance<=C.MaxDistance end,["ShoomPile"]=function(C,D)C.MaxDistance=t[C.Tag]*D;if C.Distance<=C.MaxDistance then local N=l.ALL_SHOOM_PILES[C.Root:GetAttribute("Id")]return N and not N:IsHidden()end;return false end}local function O(z)local P=m:GetDataClassFromModel(z)if P then local Q=P.Player;local R=string.format("%s (@%s)",Q.DisplayName,Q.Name)local S=P:Get("Tier")local T=P:Get("Elder")local U=n.GetSpeciesFromName(P.Species)local V=i.GetDisplayName(U.Name,U)local x=d:GetCurrentCharacter()local W=x.CharacterData:Get("Tier")local X=S==W and"Medium"or(S<W and"Low"or"High")local Y=q[X].Color;local Z=q[X].Name;local _=P:Get("Aggression")and P:Get("Aggression")>0;return R,V,T and"Elder"or nil,Y,Q,Z,_ end end;function Sniff()local x=d:GetCurrentCharacter()if not x then return end;local D=1;f:Clear()local a0=workspace.CurrentCamera.CFrame;local a1={}for a2,a3 in pairs(s)do for a2,z in pairs(a:GetTagged(a3))do if z.Parent then local a4=z:GetPivot()local a5=(a0.p-a4.p).Magnitude;local a6=w[a3]local a7=nil;if a6.GetColor then a7=a6.GetColor(z)else a7=a6.Color end;local C={Root=z,Tag=a3,Distance=a5,Image=a6.GetImage and a6.GetImage()or a6.Image,ImageSize=a6.ImageSize,Color=a7,BasePivot=a4}if a3=="Character"then local R,U,a8,a9,Q,aa,_=O(z)C.Username=R;C.NameText=U;C.PrefixText=a8;C.Color=a9;C.Player=Q;C.HoverLabel=aa;C.IsAggressive=_ end;if a3=="DrinkableWater"and z.PrimaryPart then a4=a4+z.PrimaryPart.Size*Vector3.new(0,0.5,0)C.BasePivot=a4 end;table.insert(a1,C)end end end;table.sort(a1,function(ab,ac)return ab.Distance<ac.Distance end)local ad={}local ae={}local af={}local ag={}local ah={}local ai={}local aj={}for a2,z in pairs(a1)do local ak=B[z.Tag]if ak and ak(z,D)then if z.Tag=="Food"or z.Tag=="Egg"then table.insert(ad,z)elseif z.Tag=="DrinkableWater"then table.insert(ae,z)elseif z.Tag=="Mud"then table.insert(af,z)elseif z.Tag=="Token"then table.insert(ag,z)elseif z.Tag=="NPC"then table.insert(ah,z)elseif z.Tag=="Character"then table.insert(ai,z)elseif z.Tag=="ShoomPile"then table.insert(aj,z)end end end;f.new(ad[1])f.new(ae[1])f.new(ad[2])f.new(ae[2])for a2,al in pairs(ai)do f.new(al,true)end;for a2,am in pairs(af)do f.new(am)end;for a2,an in pairs(ag)do f.new(an)end;for a2,ao in pairs(ah)do f.new(ao)end;for a2,N in pairs(aj)do f.new(N)end;g.setLightingMode("Sniff",true)h.setModifier("Sniff",true)j.PlayLocalSound(c.Effects.Whistle)local ap=o*1.5 or o;task.delay(ap,function()g.setLightingMode("Sniff",false)h.setModifier("Sniff",false)end)end;return Sniff
